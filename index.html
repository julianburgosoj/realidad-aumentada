<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Esc√°ner AR interactivo</title>

    <!-- ‚úÖ Librer√≠a de MindAR y A-Frame -->
    <script src="https://cdn.jsdelivr.net/npm/aframe@1.5.0/dist/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.4/dist/mindar-image-aframe.prod.js"></script>

    <!-- ‚úÖ Estilos de interfaz -->
    <style>
      body {
        margin: 0;
        overflow: hidden;
        background-color: black;
        font-family: 'Poppins', sans-serif;
      }

      /* Contenedor del bot√≥n inicial */
      #pantalla-inicial {
        position: absolute;
        width: 100%;
        height: 100%;
        background: radial-gradient(circle at center, #222, #000);
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        z-index: 10;
        color: white;
        text-align: center;
      }

      #btn-escanear {
        background-color: #00aaff;
        border: none;
        padding: 15px 35px;
        border-radius: 30px;
        color: white;
        font-size: 18px;
        cursor: pointer;
        transition: 0.3s;
      }

      #btn-escanear:hover {
        background-color: #0088cc;
      }

      /* Escena de AR */
      #escena-ar {
        width: 100%;
        height: 100%;
        display: none; /* Se activa solo despu√©s de oprimir el bot√≥n */
      }

      /* Asegura que la c√°mara est√© visible en vivo detr√°s del modelo */
      a-scene {
        position: fixed;
        top: 0;
        left: 0;
        z-index: 1;
      }
    </style>
  </head>

  <body>
    <!-- üü£ Pantalla inicial -->
    <div id="pantalla-inicial">
      <h1>‚ú® Esc√°ner de Dise√±o AR ‚ú®</h1>
      <p>Toca el bot√≥n para activar la c√°mara y ver tu modelo en realidad aumentada</p>
      <button id="btn-escanear">Escanear dise√±o</button>
    </div>

    <!-- üü¢ Escena de Realidad Aumentada -->
    <a-scene
      id="escena-ar"
      mindar-image="imageTargetSrc: ./targets.mind;"
      vr-mode-ui="enabled: false"
      device-orientation-permission-ui="enabled: false"
      embedded
      renderer="colorManagement: true, physicallyCorrectLights: true"
    >
      <!-- C√°mara AR -->
      <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

      <!-- Contenedor del modelo -->
      <a-entity mindar-image-target="targetIndex: 0">
        <!-- Modelo 3D interactivo -->
        <a-gltf-model
          src="./model.glb"
          rotation="0 180 0"
          scale="0.5 0.5 0.5"
          gesture-handler
        ></a-gltf-model>
      </a-entity>
    </a-scene>

    <!-- üß† Script para activar AR solo al oprimir el bot√≥n -->
    <script>
      const btn = document.getElementById("btn-escanear");
      const pantallaInicial = document.getElementById("pantalla-inicial");
      const escenaAR = document.getElementById("escena-ar");

      btn.addEventListener("click", () => {
        pantallaInicial.style.display = "none"; // Oculta pantalla de inicio
        escenaAR.style.display = "block"; // Muestra la escena AR
      });
    </script>

    <!-- ‚úã Script para permitir rotar el modelo con los dedos -->
    <script>
      AFRAME.registerComponent("gesture-handler", {
        init: function () {
          this.isDragging = false;
          this.previousX = 0;

          this.el.sceneEl.canvas.addEventListener("touchstart", (e) => {
            this.isDragging = true;
            this.previousX = e.touches[0].clientX;
          });

          this.el.sceneEl.canvas.addEventListener("touchmove", (e) => {
            if (!this.isDragging) return;
            const deltaX = e.touches[0].clientX - this.previousX;
            this.previousX = e.touches[0].clientX;
            this.el.object3D.rotation.y += deltaX * 0.01; // rotaci√≥n suave
          });

          this.el.sceneEl.canvas.addEventListener("touchend", () => {
            this.isDragging = false;
          });
        },
      });
    </script>
  </body>
</html>











